.PHONY: run build scrape load chat up-proxy down clean rebuild

run: build up-proxy scrape load  ## Build images, start proxy, scrape articles, and load them into vector DB
	@echo "âœ… Data ingestion pipeline finished. Use 'make chat' to start interactive podcast generation."

build:
	docker compose build scraper loader       

up-proxy:
	docker compose up -d dbproxy

scrape:
	docker compose run --rm scraper

load:
	docker compose run --rm loader

# retrieve:  # Retriever is called by chatter service, not run standalone

tts:  ## Test TTS service
	docker compose run --rm tts

chat:  ## Start interactive podcast generation with Gemini and TTS (includes retrieval)
	docker compose run --rm chatter

down:
	docker compose down

clean: down
	@echo "ðŸ’¥ (kept artifacts/. Delete manually if you want a fresh file)"